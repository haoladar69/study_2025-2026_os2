---
## Front matter
title: "Отчёт по лабораторной работе №14"
subtitle: "Партиции, файловые системы, монтирование"
author: "Шаханеоядж Хаоладар"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки создания разделов на диске и файловых систем. Получить навыки монтирования файловых систем.

# Выполнение

## Создание разделов MBR с помощью fdisk

1. После получения полномочий администратора выполнен просмотр текущей разметки всех дисков.  
   На экране появились сведения обо всех устройствах, включая добавленные диски /dev/sdb и /dev/sdc объёмом 1.5 GiB.

   ![Просмотр всех дисков](Screenshot_1.png){ #fig:001 width=80% }

2. Разметка диска /dev/sdb выполнялась через утилиту fdisk.  
   При запуске fdisk сообщила об отсутствии таблицы разделов и создала новую MBR-разметку.  
   Для ознакомления была открыта справка по командам.

   ![Справка по командам fdisk](Screenshot_2.png){ #fig:002 width=80% }

3. Затем был просмотрен текущий список разделов и доступное пространство.  
   После проверки свободных секторов начато создание нового раздела.

4. Создание основного раздела происходило с выбором типа *primary*, первого свободного сектора и указанием размера 300 MiB.  
   После завершения структура была записана на диск.

   ![Создание основного раздела](Screenshot_3.png){ #fig:003 width=80% }

5. Состояние новой таблицы было проверено и сравнивалось с информацией ядра.  
   До обновления таблица разделов в /proc/partitions отражалась без изменений.

   ![Проверка разделов](Screenshot_4.png){ #fig:004 width=80% }

6. Для обновления таблицы разделов в ядре применялась команда partprobe.

## Создание расширенного и логического разделов

1. Повторно была запущена утилита fdisk для диска /dev/sdb.  
   Создан расширенный раздел, занявший весь оставшийся объём.

2. После этого добавлен логический раздел внутри расширенного, размером 300 MiB.  
   Изменения были записаны, а таблица разделов обновлена.

3. Затем просмотрена информация о созданных разделах в системе.

   ![Создание расширенного и логического разделов](Screenshot_5.png){ #fig:005 width=80% }
   
   ![Проверка разделов](Screenshot_6.png){ #fig:006 width=80% }


## Создание раздела подкачки (swap)

1. Запуск fdisk вновь позволил добавить ещё один логический раздел под номером 6.  
   Его размер также составил 300 MiB.

2. Тип раздела был изменён на *Linux swap* (код 82).  
   После сохранения изменений таблица была обновлена с помощью partprobe.

3. Далее раздел был отформатирован под swap и активирован системой.  
   После включения пространство подкачки появилось в выводе системной статистики.
   
    ![Создание разделов](Screenshot_7.png){ #fig:007 width=80% }

   ![Активация swap](Screenshot_8.png){ #fig:008 width=80% }

## Создание разделов GPT с помощью gdisk

1. После получения прав администратора была просмотрена текущая информация о диске /dev/sdc.  
   Таблица разделов не обнаружена, что подтверждает отсутствие предыдущих разметок.

2. Для разметки диска была запущена утилита gdisk.  
   На диске отсутствовала корректная таблица разделов, поэтому утилита создала новую GPT.

3. Затем был создан новый раздел — выбран раздел с номером по умолчанию.  
   В качестве начального сектора используется первый доступный сектор.  
   Размер раздела был определён как 300 MiB.

4. Тип раздела установлен 8300 (Linux filesystem).  
   После создания был выполнен просмотр разметки и записаны изменения на диск.

   ![Создание GPT-раздела](Screenshot_9.png){ #fig:009 width=80% }

5. Был выполнен вывод содержимого /proc/partitions для проверки того, что ядро не обновило таблицу автоматически.

6. Для обновления таблицы разделов использована команда partprobe.  
   После обновления состояние GPT-таблицы было проверено с помощью gdisk -l.

   ![Проверка диска после partprobe](Screenshot_10.png){ #fig:010 width=80% }

## Форматирование файловой системы 

1. Для раздела /dev/sdb1 была создана файловая система XFS.  
   Далее на неё назначена метка xfsdisk.

   ![Создание XFS и Создание EXT4](Screenshot_11.png){ #fig:011 width=80% }

2. На разделе /dev/sdb5 была создана файловая система EXT4.  
   Далее ей была назначена метка ext4disk.  
   Были установлены параметры монтирования по умолчанию: acl и user_xattr.

## Ручное монтирование файловых систем

1. Создана точка монтирования /mnt/tmp.  
   Раздел /dev/sdb5 был смонтирован вручную.  
   Проверка вывода mount подтвердила корректность монтирования.

2. Далее раздел был корректно отмонтирован, что также подтверждено выводом mount.

3. Создана новая точка монтирования /mnt/data для дальнейшего постоянного подключения раздела /dev/sdb1.

4. Получен список устройств и их UUID с помощью blkid.

   ![Монтирование и вывод blkid](Screenshot_12.png){ #fig:012 width=80% }


## Монтирование разделов с помощью /etc/fstab

1. Полученный UUID раздела /dev/sdb1 был добавлен в файл /etc/fstab.  
   Запись была добавлена в формате:
   
![Редактирование /etc/fstab](Screenshot_13.png){ #fig:013 width=80% }

2. После изменения конфигурации была выполнена проверка

3. Вывод df -h показал, что раздел /dev/sdb1 успешно примонтирован в /mnt/data.

![Результат автоматического монтирования](Screenshot_14.png){ #fig:014 width=80% }

## Самостоятельная работа: создание двух GPT-разделов и их автоматическое монтирование

1. В утилите gdisk на диске /dev/sdc был создан третий GPT-раздел.  
   Размер каждого нового раздела — 100 MiB.  
   Один из них был назначен под файловую систему Linux (код 8300), второй — под пространство подкачки (код 8200).

   ![Создание раздела и изменение его типа](Screenshot_15.png){ #fig:015 width=80% }

2. После записи таблицы разделов структура диска была проверена с помощью gdisk -l.  
   На диске теперь присутствуют три раздела:  
   — два раздела Linux filesystem,  
   — один раздел Linux swap.

3. Раздел /dev/sdc2 был отформатирован в ext4.  
   Затем ему назначена метка ext4disk.  
   Параметры файловой системы были дополнительно настроены: включены ACL и расширенные атрибуты.

4. Раздел /dev/sdc3 был подготовлен как область подкачки с помощью mkswap.

   ![Форматирование ext4 и создание swap](Screenshot_16.png){ #fig:016 width=80% }

5. В файл /etc/fstab были добавлены две записи:  
   — ext4-раздел /dev/sdc2, примонтированный в /mnt/data-ext;  
   — раздел подкачки /dev/sdc3, настроенный как swap.

6. Записи в файле fstab используют UUID-идентификаторы, что обеспечивает корректное монтирование при каждой загрузке системы.

   ![Настройка /etc/fstab](Screenshot_17.png){ #fig:017 width=80% }


7. После выполнения `mount -a` и перезагрузки системы было проверено:  
   — что раздел ext4 примонтирован в /mnt/data-ext,  
   — что пространство подкачки активно.

8. Команда df -h показала корректное подключение файловой системы.  
   Команда mount | grep mnt подтвердила используемый тип и параметры монтирования.  
   Команда free -m показала активное swap-пространство.

   ![Проверка монтирования и swap](Screenshot_18.png){ #fig:018 width=80% }

# Контрольные вопросы

1. Какой инструмент используется для создания разделов GUID?  
   **gdisk** — утилита для разметки дисков в формате GPT.

2. Какой инструмент применяется для создания разделов MBR?  
   **fdisk** — инструмент для создания и управления разделами MBR.

3. Какой файл используется для автоматического монтирования разделов во время загрузки?  
   **/etc/fstab** — конфигурационный файл для автмонтирования.

4. Какой вариант монтирования целесообразно выбрать, если необходимо, чтобы файловая система не была автоматически примонтирована во время загрузки?  
   Использование параметра **noauto**.

5. Какая команда позволяет форматировать раздел с типом 82 с соответствующей файловой системой?  
   Использование команды **mkswap** для подготовки раздела подкачки.

6. Как можно безопасно проверить, будет ли автмонтирование работать без перезагрузки?  
   С помощью выполнения **mount -a** для проверки всех записей в /etc/fstab.

7. Какая файловая система создаётся при использовании команды mkfs без указания типа?  
   По умолчанию создаётся файловая система **ext2**.

8. Как форматировать раздел EXT4?  
   С помощью команды **mkfs.ext4**.

9. Как найти UUID для всех устройств на компьютере?  
   Использовать команду **blkid**, отображающую UUID и другие сведения об устройствах.

# Заключение

Освоены практические навыки разметки дисков с помощью **fdisk** и **gdisk**, создание разделов в схемах **MBR** и **GPT**, форматирование файловых систем **XFS** и **EXT4**, настройка пространства подкачки и автоматического монтирования через **/etc/fstab**.
