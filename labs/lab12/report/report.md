---
## Front matter
title: "Отчёт по лабораторной работе №12"
subtitle: "Настройки сети в Linux"
author: "Шаханеоядж Хаоладар"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки настройки сетевых параметров системы.

# Выполнение

## Проверка конфигурации сети

1. Сначала были получены права суперпользователя с помощью команды **su -**.  
   Это позволило выполнять сетевые операции, требующие административных полномочий.  

2. Для просмотра информации о сетевых интерфейсах и статистике переданных пакетов использовалась команда **ip -s link**.  
   В выводе отображены интерфейсы **lo** (loopback) и **enp0s3**.  
   Интерфейс `enp0s3` находится в состоянии **UP**, что означает его активность.  
   Показатели RX/TX указывают количество принятых и отправленных пакетов соответственно, а также ошибки и коллизии.  

   ![Вывод команды ip -s link](Screenshot_1.png){ #fig:001 width=80% }

3. Для просмотра таблицы маршрутизации использовалась команда **ip route show**.  
   Вывод показал маршрут по умолчанию через шлюз `10.0.2.2` и локальную сеть `10.0.2.0/24`, связанный с интерфейсом **enp0s3**.  
   Это означает, что весь исходящий трафик направляется через данный шлюз в интернет.  

4. Для получения сведений о назначении IP-адресов применялась команда **ip addr show**.  
   Интерфейс **enp0s3** имеет IPv4-адрес **10.0.2.15/24** и несколько IPv6-адресов.  
   Интерфейс **lo** служит для локальных соединений с адресом **127.0.0.1**.  

   ![Вывод ip addr show](Screenshot_2.png){ #fig:002 width=80% }

   Таким образом, устройство использует адаптер **enp0s3** с основным IPv4-адресом **10.0.2.15**.  

5. Для проверки подключения к интернету выполнена команда **ping -c 4 8.8.8.8**.  
   Все четыре пакета были успешно получены, что подтверждает наличие сетевого соединения и корректную работу маршрутов.  

   ![Проверка подключения к интернету с помощью ping](Screenshot_3.png){ #fig:003 width=80% }

6. Для добавления дополнительного адреса к интерфейсу **enp0s3** использовалась команда  
   **ip addr add 10.0.0.10/24 dev enp0s3**.  
   После этого повторный вызов **ip addr show** подтвердил наличие нового IP-адреса в списке.  

   ![Добавление дополнительного IP-адреса](Screenshot_4.png){ #fig:004 width=80% }

7. Для сравнения утилит **ip** и **ifconfig** была выполнена команда **ifconfig**.  
   Вывод утилиты показал ту же информацию: активный интерфейс **enp0s3** с адресом **10.0.2.15**,  
   маской подсети `255.255.255.0` и широковещательным адресом `10.0.2.255`.  

   ![Сравнение вывода ifconfig](Screenshot_5.png){ #fig:005 width=80% }

8. Для получения списка всех прослушиваемых системой портов использовалась команда **ss -tul**.  
   Отображены активные TCP- и UDP-порты, включая **ssh**, **http**, **ftp**, **ipp** и **mdns**, что свидетельствует о запущенных сетевых службах.  

   ![Прослушиваемые порты TCP и UDP](Screenshot_6.png){ #fig:006 width=80% }
   
## Управление сетевыми подключениями с помощью nmcli

1. Сначала были получены права суперпользователя с помощью команды **su -**.  
   Затем выполнена команда **nmcli connection show** для просмотра существующих подключений.  
   В списке отображены интерфейсы **enp0s3** и **lo** (loopback).  

   ![Просмотр существующих подключений](Screenshot_7.png){ #fig:007 width=80% }

2. Добавлено новое Ethernet-соединение с именем **dhcp** для интерфейса **enp0s3**:  
   **nmcli connection add con-name "dhcp" type ethernet ifname enp0s3**.  
   После выполнения команда **nmcli connection show** подтвердила успешное создание подключения.  

3. Добавлено второе соединение с именем **static** с заданием статического IP-адреса и шлюза:  
   **nmcli connection add con-name "static" ifname enp0s3 autoconnect no type ethernet ip4 10.0.0.10/24 gw4 10.0.0.1**.  
   В списке подключений появилось новое соединение **static**, не активированное по умолчанию.  

4. Для проверки списка подключений снова была выполнена команда **nmcli connection show**,  
   где отобразились четыре записи: **enp0s3**, **lo**, **dhcp** и **static**.  

5. Далее активировано статическое соединение командой **nmcli connection up static**.  
   После этого команда **nmcli connection show** подтвердила его активацию, а **ip addr** показала назначение IP-адреса **10.0.0.10/24** интерфейсу **enp0s3**.  

   ![Активация статического соединения](Screenshot_8.png){ #fig:008 width=80% }

6. Затем выполнено переключение обратно на соединение **dhcp** командой **nmcli connection up dhcp**.  
   После активации DHCP-интерфейс **enp0s3** получил динамический адрес **10.0.2.15/24**, что подтверждено выводом **ip addr**.  

   ![Переключение на соединение DHCP](Screenshot_9.png){ #fig:009 width=80% }
   
## Изменение параметров соединения с помощью nmcli

1. Для начала статическому соединению было отключено автоматическое подключение командой  
   **nmcli connection modify static connection.autoconnect no**.  
   Это позволяет вручную выбирать нужный профиль сети при переключении.  

2. Затем был добавлен DNS-сервер **10.0.0.10** к соединению **static** с помощью команды  
   **nmcli connection modify static ipv4.dns 10.0.0.10**.  
   Для добавления второго DNS-сервера использована команда  
   **nmcli connection modify static +ipv4.dns 8.8.8.8**,  
   где знак **+** означает добавление, а не замену параметра.  

3. Далее изменён основной IP-адрес интерфейса командой  
   **nmcli connection modify static ipv4.addresses 10.0.0.20/24**,  
   а затем добавлен дополнительный адрес  
   **nmcli connection modify static +ipv4.addresses 10.20.30.40/16**.  

4. После изменения конфигурации соединение активировано командой  
   **nmcli connection up static**.  
   Проверка при помощи **nmcli connection show** подтвердила успешную активацию профиля **static** для интерфейса **enp0s3**.  

   ![Активация статического соединения после изменения параметров](Screenshot_10.png){ #fig:010 width=80% }

5. Команда **ip addr** показала, что интерфейсу **enp0s3** теперь назначены два IPv4-адреса — **10.0.0.20/24** и **10.20.30.40/16**.  
   Также интерфейс имеет статические параметры маршрута и DNS.  

   ![Проверка адресов после изменений](Screenshot_11.png){ #fig:011 width=80% }

6. Для просмотра и редактирования параметров через текстовый интерфейс была запущена утилита **nmtui**.  
   В ней видно, что профиль **static** содержит два IP-адреса, шлюз **10.0.0.1** и два DNS-сервера (**10.0.0.10** и **8.8.8.8**).  

   ![Параметры статического соединения в nmtui](Screenshot_12.png){ #fig:012 width=80% }

   ![Параметры dhcp соединения в nmtui](Screenshot_13.png){ #fig:013 width=80% }

7. Через графический интерфейс также проверены настройки сети.  
   Для профиля **static** указаны IP-адрес **10.20.30.40**, шлюз **10.0.0.1**, и DNS-сервера **10.0.0.10**, **8.8.8.8**.  

   ![Просмотр параметров static в графическом интерфейсе](Screenshot_14.png){ #fig:014 width=80% }

8. Затем выполнено переключение обратно на соединение **dhcp** с помощью команды  
   **nmcli connection up dhcp**.  
   После активации интерфейс **enp0s3** снова получил динамический IP-адрес **10.0.2.15** и соответствующие параметры шлюза и DNS.  

   ![Переключение на соединение DHCP](Screenshot_15.png){ #fig:015 width=80% }

   
# Контрольные вопросы

1. Какая команда отображает только статус соединения, но не IP-адрес?  
   **nmcli device status** — показывает состояние сетевых устройств (connected, disconnected и т.д.) без указания IP-адресов.  

2. Какая служба управляет сетью в ОС типа RHEL?  
   **NetworkManager** — основная служба, управляющая сетевыми интерфейсами и подключениями.  

3. Какой файл содержит имя узла (устройства) в ОС типа RHEL?  
   Файл **/etc/hostname** — хранит текущее имя хоста системы.  

4. Какая команда позволяет вам задать имя узла (устройства)?  
   **hostnamectl set-hostname имя_узла** — изменяет имя хоста и обновляет запись в `/etc/hostname`.  

5. Какой конфигурационный файл можно изменить для включения разрешения имён для конкретного IP-адреса?  
   **/etc/hosts** — файл, содержащий соответствие IP-адресов и имён узлов, используемый для локального DNS-разрешения.  

6. Какая команда показывает текущую конфигурацию маршрутизации?  
   **ip route show** — выводит активные маршруты сети и шлюзы по умолчанию.  

7. Как проверить текущий статус службы NetworkManager?  
   **systemctl status NetworkManager** — показывает состояние службы, активна ли она и запущена ли в данный момент.  

8. Какая команда позволяет вам изменить текущий IP-адрес и шлюз по умолчанию для вашего сетевого соединения?  
   **nmcli connection modify имя_соединения ipv4.addresses адрес/маска gw4 шлюз** — задаёт новый IP-адрес и шлюз.  
   После изменения для применения настроек выполняется команда **nmcli connection up имя_соединения**.  


# Заключение  

В ходе работы были изучены команды **nmcli**, **nmtui** и **ip**, а также принципы настройки сетевых интерфейсов, маршрутов и DNS-серверов в ОС семейства RHEL. Получены практические навыки управления соединениями и проверки их состояния как в консольном, так и в графическом интерфейсе.
